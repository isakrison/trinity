<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>HTML Game Tutorial</title>
</head>
<body onload="startGame()">
    <script type="text/javascript">

        var Direction = {
            up		: 1,
            down	: 2
        }
		
		var CellShape = {
			center	: 1,
			petal	: 2,
			vertex	: 3
		}
		
		var GamePiece = {
			redSquare		: 1,
			yellowCircle	: 2,
			greenTriangle	: 3,
			blueRectangle	: 4,
			purpleOval		: 5,
			blackDiamond	: 6
		}

        // initial setup
        var gameSize = 3;                                                   			// number of circles on one side of the hex
        var radius = 100;                                                       		// radius of each circle
        var circleSpacing = Math.round(Math.cos(convertToRadians(60)) * radius);        // one-half the distance between circle radii
        var gameAreaWidth = (2 * radius) + 2 * circleSpacing * ((gameSize * 2) - 1);  	// width of the square area containing the game board
        var gameAreaHeight = gameAreaWidth                                      		// height of the square area containing the game board
		var canvasPadding = 5															// margin of error for drawing things close to the edge
        var circleLineWidth = 3;                                                      	// circle outline thickness
        var circleLineColor = "gold";                                                 	// circle outline color
        var startingX = radius;                                                 		// first circle x coord
        var startingY = gameAreaHeight / 2;                                     		// first circle y coord
        var xIncrement = circleSpacing;                                         		// one-half horizontal distance between circle radii
        var yIncrement = Math.round(Math.tan(convertToRadians(60)) * xIncrement);       // vertical distance between rows
        var myCircles = []; 	                                                		// array of game circles

        // here, we declare myGameArea as an object with properties (canvas) and methods (start).
        var myGameArea = {
            canvas	: document.createElement("canvas"),
            start	: function () {
						alert("cos(60) = " + Math.cos(convertToRadians(60)) + "; gameAreaWidth = " + gameAreaWidth);
						this.canvas.width = gameAreaWidth + (canvasPadding * 2);
						this.canvas.height = gameAreaHeight + (canvasPadding * 2);
						this.context = this.canvas.getContext("2d");                          	// provides a context object for drawing 2d stuff (as opposed to 3d or bitmap)
						document.body.insertBefore(this.canvas, document.body.childNodes[0]);   // inserts the canvas as the very first child of the document - i.e., top of page unless styled otherwise
						//this.interval = setInterval(updateGameArea, 20);
            },
            clear	: function () {
						this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
            }
        }		
		
        function drawCircles() {
            var x, y;
            var centerRowIndex = gameSize - 1;
            var rowOffset;
            // generate rows from the outside in
            for (i = 0; i < gameSize; i++) {
                rowOffset = centerRowIndex - i;
				x = transformX(startingX, rowOffset);
                y = transformY(startingY, rowOffset, Direction.up);
                myCircles[centerRowIndex - rowOffset] = generateRow(i, x, y);
                if (rowOffset > 0) {
                    y = transformY(startingY, rowOffset, Direction.down);
                    myCircles[centerRowIndex + rowOffset] = generateRow(i, x, y);
                }
            }
			for (i = 0; i < myCircles.length; i++) {
				for (j = 0; j < myCircles[i].length; j++) {
					myCircles[i][j].draw();
				}
			}
        }

        function generateRow(i, x, y){
			var row = [];
			this.x = x;
			this.y = y;
			
            for (j = 0; j < gameSize + i; j++) {
				this.x = transformX(x, j * 2);
				row[j] = new circle(i, j, this.x, this.y);
            }
			
			return row;
        }

        function transformX(x, increments) {
			return x + (xIncrement * increments);
        }

        function transformY(y, increments, direction) {
			if (direction == Direction.up) {
				return y - (yIncrement * increments);
			} else {
				return y + (yIncrement * increments);
			}
        }

        function circle(rowNumber, rowPosition, x, y) {
			this.rowNumber = rowNumber;		// which row this circle is in (first row is zero)
			this.rowPosition = rowPosition;	// what position this circle occupies in its row (first position is zero)
            this.x = x + canvasPadding;		// center x coordinate
            this.y = y + canvasPadding;		// center y coordinate
			this.cells = [new cell(0), new cell(1), new cell(2), new cell(3), new cell(4), new cell(5), new cell(6),
							new cell(7), new cell(8), new cell(9), new cell(10), new cell(11), new cell(12)];
			this.draw = function() {
				/*
					What you want to do here, instead, is:
						~ find the coordinates of six points on the diameter of the circle at odd clock numbers
							- track all vertices as their own thing; circles have pointers to them
						~ together with the center point, these form six equilateral triangles
						~ draw three arcs inside each triangle such that they overlap - arc or quadratic; see what works best
						~ edges are automatically handled with this method
				*/
				context = myGameArea.context;
				context.lineWidth = circleLineWidth;
				context.strokeStyle = circleLineColor;
				context.beginPath();
				context.arc(this.x, this.y, radius, 0, 2 * Math.PI, false); // x, y, radius, start angle, end angle, boolean counterclockwise
				context.stroke();
			}
        }
		
		function cell(clockPosition) {
			this.clockPosition = clockPosition;
			this.shape;
			this.contents;	// game tile currently occupying this cell
			
			switch(clockPosition) {
				case 0:
				case 4:
				case 8:
					this.shape = CellShape.center;
					break;
				case 2:
				case 6:
				case 10:
					this.shape = CellShape.vertex;
					break;
				default:
					this.shape = CellShape.petal;
					break;
			}
		}

        function startGame() {
            myGameArea.start();
			drawCircles();
        }

        function updateGameArea() {
            myGameArea.clear();
			drawCircles();
        }
		
		function convertToRadians(degrees) {
			return (degrees / 360) * (2 * Math.PI);
		}

    </script>
	
	<div id="messages" style="width:600px;">
	</div>
</body>
</html>